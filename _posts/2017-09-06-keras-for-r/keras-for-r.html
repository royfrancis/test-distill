<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">

<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta http-equiv="X-UA-Compatible" content="IE=Edge,chrome=1"/>
  <meta name="generator" content="distill" />

  <style type="text/css">
  /* Hide doc at startup (prevent jankiness while JS renders/transforms) */
  body {
    visibility: hidden;
  }
  </style>

 <!--radix_placeholder_import_source-->
 <!--/radix_placeholder_import_source-->

  <!--radix_placeholder_meta_tags-->
  <title>Keras for R</title>
  
  <meta property="description" itemprop="description" content="We are excited to announce that the keras package is now available on CRAN. The package provides an R interface to Keras, a high-level neural networks API developed with a focus on enabling fast experimentation."/>
  
  
  <!--  https://schema.org/Article -->
  <meta property="article:published" itemprop="datePublished" content="2017-09-05"/>
  <meta property="article:created" itemprop="dateCreated" content="2017-09-05"/>
  <meta name="article:author" content="J.J. Allaire"/>
  
  <!--  https://developers.facebook.com/docs/sharing/webmasters#markup -->
  <meta property="og:title" content="Keras for R"/>
  <meta property="og:type" content="article"/>
  <meta property="og:description" content="We are excited to announce that the keras package is now available on CRAN. The package provides an R interface to Keras, a high-level neural networks API developed with a focus on enabling fast experimentation."/>
  <meta property="og:locale" content="en_US"/>
  
  <!--  https://dev.twitter.com/cards/types/summary -->
  <meta property="twitter:card" content="summary"/>
  <meta property="twitter:title" content="Keras for R"/>
  <meta property="twitter:description" content="We are excited to announce that the keras package is now available on CRAN. The package provides an R interface to Keras, a high-level neural networks API developed with a focus on enabling fast experimentation."/>
  
  <!--/radix_placeholder_meta_tags-->
  <!--radix_placeholder_rmarkdown_metadata-->
  
  <script type="text/json" id="radix-rmarkdown-metadata">
  {"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["title","description","categories","author","date","preview","output"]}},"value":[{"type":"character","attributes":{},"value":["Keras for R"]},{"type":"character","attributes":{},"value":["We are excited to announce that the keras package is now available on CRAN. The package provides an R interface to Keras, a high-level neural networks API developed with a focus on enabling fast experimentation. \n"]},{"type":"character","attributes":{},"value":["TensorFlow/Keras","Packages/Releases"]},{"type":"list","attributes":{},"value":[{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","url","affiliation","affiliation_url"]}},"value":[{"type":"character","attributes":{},"value":["J.J. Allaire"]},{"type":"character","attributes":{},"value":["https://github.com/jjallaire"]},{"type":"character","attributes":{},"value":["RStudio"]},{"type":"character","attributes":{},"value":["https://www.rstudio.com"]}]}]},{"type":"character","attributes":{},"value":["09-05-2017"]},{"type":"character","attributes":{},"value":["preview.png"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["distill::distill_article"]}},"value":[{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["self_contained"]}},"value":[{"type":"logical","attributes":{},"value":[false]}]}]}]}
  </script>
  <!--/radix_placeholder_rmarkdown_metadata-->
  
  <script type="text/json" id="radix-resource-manifest">
  {"type":"character","attributes":{},"value":["keras-for-r_files/bowser-1.9.3/bowser.min.js","keras-for-r_files/distill-2.2.21/template.v2.js","keras-for-r_files/jquery-1.11.3/jquery.min.js","keras-for-r_files/webcomponents-2.0.0/webcomponents.js","preview.png"]}
  </script>
  <!--radix_placeholder_navigation_in_header-->
  <!--/radix_placeholder_navigation_in_header-->
  <!--radix_placeholder_distill-->
  
  <style type="text/css">
  
  body {
    background-color: white;
  }
  
  .pandoc-table {
    width: 100%;
  }
  
  .pandoc-table>caption {
    margin-bottom: 10px;
  }
  
  .pandoc-table th:not([align]) {
    text-align: left;
  }
  
  .pagedtable-footer {
    font-size: 15px;
  }
  
  .html-widget {
    margin-bottom: 2.0em;
  }
  
  .l-screen-inset {
    padding-right: 16px;
  }
  
  .l-screen .caption {
    margin-left: 10px;
  }
  
  .shaded {
    background: rgb(247, 247, 247);
    padding-top: 20px;
    padding-bottom: 20px;
    border-top: 1px solid rgba(0, 0, 0, 0.1);
    border-bottom: 1px solid rgba(0, 0, 0, 0.1);
  }
  
  .shaded .html-widget {
    margin-bottom: 0;
    border: 1px solid rgba(0, 0, 0, 0.1);
  }
  
  .shaded .shaded-content {
    background: white;
  }
  
  .text-output {
    margin-top: 0;
    line-height: 1.5em;
  }
  
  .hidden {
    display: none !important;
  }
  
  d-article {
    padding-bottom: 30px;
  }
  
  d-appendix {
    padding-top: 30px;
  }
  
  d-article>p>img {
    width: 100%;
  }
  
  d-article iframe {
    border: 1px solid rgba(0, 0, 0, 0.1);
    margin-bottom: 2.0em;
    width: 100%;
  }
  
  figure img.external {
    background: white;
    border: 1px solid rgba(0, 0, 0, 0.1);
    box-shadow: 0 1px 8px rgba(0, 0, 0, 0.1);
    padding: 18px;
    box-sizing: border-box;
  }
  
  /* CSS for table of contents */
  
  .d-toc {
    color: rgba(0,0,0,0.8);
    font-size: 0.8em;
    line-height: 1em;
  }
  
  .d-toc-header {
    font-size: 0.6rem;
    font-weight: 400;
    color: rgba(0, 0, 0, 0.5);
    text-transform: uppercase;
    margin-top: 0;
    margin-bottom: 1.3em;
  }
  
  .d-toc a {
    border-bottom: none;
  }
  
  .d-toc ul {
    padding-left: 0;
  }
  
  .d-toc li>ul {
    padding-top: 0.8em;
    padding-left: 16px;
    margin-bottom: 0.6em;
  }
  
  .d-toc ul,
  .d-toc li {
    list-style-type: none;
  }
  
  .d-toc li {
    margin-bottom: 0.9em;
  }
  
  .d-toc-separator {
    margin-top: 20px;
    margin-bottom: 2em;
  }
  
  .d-article-with-toc {
    border-top: none;
    padding-top: 0;
  }
  
  
  
  /* Tweak code blocks (note that this CSS is repeated above in an injection
     into the d-code shadow dom) */
  
  d-code {
    overflow-x: auto !important;
  }
  
  pre.d-code code.d-code {
    padding-left: 10px;
    font-size: 12px;
    border-left: 2px solid rgba(0,0,0,0.1);
  }
  
  pre.text-output {
  
    font-size: 12px;
    color: black;
    background: none;
    font-family: Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace;
    text-align: left;
    white-space: pre;
    word-spacing: normal;
    word-break: normal;
    word-wrap: normal;
    line-height: 1.5;
  
    -moz-tab-size: 4;
    -o-tab-size: 4;
    tab-size: 4;
  
    -webkit-hyphens: none;
    -moz-hyphens: none;
    -ms-hyphens: none;
    hyphens: none;
  }
  
  @media(min-width: 768px) {
  
  d-code {
    overflow-x: visible !important;
  }
  
  pre.d-code code.d-code  {
      padding-left: 18px;
      font-size: 14px;
  }
  pre.text-output {
    font-size: 14px;
  }
  }
  
  /* Figure */
  
  .figure {
    position: relative;
    margin-bottom: 2.5em;
    margin-top: 1.5em;
  }
  
  .figure img {
    width: 100%;
  }
  
  .figure .caption {
    color: rgba(0, 0, 0, 0.6);
    font-size: 12px;
    line-height: 1.5em;
  }
  
  .figure img.external {
    background: white;
    border: 1px solid rgba(0, 0, 0, 0.1);
    box-shadow: 0 1px 8px rgba(0, 0, 0, 0.1);
    padding: 18px;
    box-sizing: border-box;
  }
  
  .figure .caption a {
    color: rgba(0, 0, 0, 0.6);
  }
  
  .figure .caption b,
  .figure .caption strong, {
    font-weight: 600;
    color: rgba(0, 0, 0, 1.0);
  }
  
  
  
  /* Tweak 1000px media break to show more text */
  
  @media(min-width: 1000px) {
    .base-grid,
    distill-header,
    d-title,
    d-abstract,
    d-article,
    d-appendix,
    distill-appendix,
    d-byline,
    d-footnote-list,
    d-citation-list,
    distill-footer {
      grid-template-columns: [screen-start] 1fr [page-start kicker-start] 80px [middle-start] 50px [text-start kicker-end] 65px 65px 65px 65px 65px 65px 65px 65px [text-end gutter-start] 65px [middle-end] 65px [page-end gutter-end] 1fr [screen-end];
      grid-column-gap: 16px;
    }
  
    .grid {
      grid-column-gap: 16px;
    }
  
    d-article {
      font-size: 1.06rem;
      line-height: 1.7em;
    }
    figure .caption, .figure .caption, figure figcaption {
      font-size: 13px;
    }
  }
  
  @media(min-width: 1180px) {
    .base-grid,
    distill-header,
    d-title,
    d-abstract,
    d-article,
    d-appendix,
    distill-appendix,
    d-byline,
    d-footnote-list,
    d-citation-list,
    distill-footer {
      grid-template-columns: [screen-start] 1fr [page-start kicker-start] 60px [middle-start] 60px [text-start kicker-end] 60px 60px 60px 60px 60px 60px 60px 60px [text-end gutter-start] 60px [middle-end] 60px [page-end gutter-end] 1fr [screen-end];
      grid-column-gap: 32px;
    }
  
    .grid {
      grid-column-gap: 32px;
    }
  }
  
  
  /* Get the citation styles for the appendix (not auto-injected on render since
     we do our own rendering of the citation appendix) */
  
  d-appendix .citation-appendix,
  .d-appendix .citation-appendix {
    font-size: 11px;
    line-height: 15px;
    border-left: 1px solid rgba(0, 0, 0, 0.1);
    padding-left: 18px;
    border: 1px solid rgba(0,0,0,0.1);
    background: rgba(0, 0, 0, 0.02);
    padding: 10px 18px;
    border-radius: 3px;
    color: rgba(150, 150, 150, 1);
    overflow: hidden;
    margin-top: -12px;
    white-space: pre-wrap;
    word-wrap: break-word;
  }
  
  
  /* Social footer */
  
  .social_footer {
    margin-top: 30px;
    margin-bottom: 0;
    color: rgba(0,0,0,0.67);
  }
  
  .disqus-comments {
    margin-right: 30px;
  }
  
  .disqus-comment-count {
    border-bottom: 1px solid rgba(0, 0, 0, 0.4);
    cursor: pointer;
  }
  
  #disqus_thread {
    margin-top: 30px;
  }
  
  .article-sharing a {
    border-bottom: none;
    margin-right: 8px;
  }
  
  .article-sharing a:hover {
    border-bottom: none;
  }
  
  .sidebar-section.subscribe {
    font-size: 12px;
    line-height: 1.6em;
  }
  
  .subscribe p {
    margin-bottom: 0.5em;
  }
  
  
  .article-footer .subscribe {
    font-size: 15px;
    margin-top: 45px;
  }
  
  
  /* Improve display for browsers without grid (IE/Edge <= 15) */
  
  .downlevel {
    line-height: 1.6em;
    font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Oxygen, Ubuntu, Cantarell, "Fira Sans", "Droid Sans", "Helvetica Neue", Arial, sans-serif;
    margin: 0;
  }
  
  .downlevel .d-title {
    padding-top: 6rem;
    padding-bottom: 1.5rem;
  }
  
  .downlevel .d-title h1 {
    font-size: 50px;
    font-weight: 700;
    line-height: 1.1em;
    margin: 0 0 0.5rem;
  }
  
  .downlevel .d-title p {
    font-weight: 300;
    font-size: 1.2rem;
    line-height: 1.55em;
    margin-top: 0;
  }
  
  .downlevel .d-byline {
    padding-top: 0.8em;
    padding-bottom: 0.8em;
    font-size: 0.8rem;
    line-height: 1.8em;
  }
  
  .downlevel .section-separator {
    border: none;
    border-top: 1px solid rgba(0, 0, 0, 0.1);
  }
  
  .downlevel .d-article {
    font-size: 1.06rem;
    line-height: 1.7em;
    padding-top: 1rem;
    padding-bottom: 2rem;
  }
  
  
  .downlevel .d-appendix {
    padding-left: 0;
    padding-right: 0;
    max-width: none;
    font-size: 0.8em;
    line-height: 1.7em;
    margin-bottom: 0;
    color: rgba(0,0,0,0.5);
    padding-top: 40px;
    padding-bottom: 48px;
  }
  
  .downlevel .footnotes ol {
    padding-left: 13px;
  }
  
  .downlevel .base-grid,
  .downlevel .distill-header,
  .downlevel .d-title,
  .downlevel .d-abstract,
  .downlevel .d-article,
  .downlevel .d-appendix,
  .downlevel .distill-appendix,
  .downlevel .d-byline,
  .downlevel .d-footnote-list,
  .downlevel .d-citation-list,
  .downlevel .distill-footer,
  .downlevel .appendix-bottom,
  .downlevel .posts-container {
    padding-left: 40px;
    padding-right: 40px;
  }
  
  @media(min-width: 768px) {
    .downlevel .base-grid,
    .downlevel .distill-header,
    .downlevel .d-title,
    .downlevel .d-abstract,
    .downlevel .d-article,
    .downlevel .d-appendix,
    .downlevel .distill-appendix,
    .downlevel .d-byline,
    .downlevel .d-footnote-list,
    .downlevel .d-citation-list,
    .downlevel .distill-footer,
    .downlevel .appendix-bottom,
    .downlevel .posts-container {
    padding-left: 150px;
    padding-right: 150px;
    max-width: 900px;
  }
  }
  
  .downlevel pre code {
    display: block;
    border-left: 2px solid rgba(0, 0, 0, .1);
    padding: 0 0 0 20px;
    font-size: 14px;
  }
  
  .downlevel code, .downlevel pre {
    color: black;
    background: none;
    font-family: Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace;
    text-align: left;
    white-space: pre;
    word-spacing: normal;
    word-break: normal;
    word-wrap: normal;
    line-height: 1.5;
  
    -moz-tab-size: 4;
    -o-tab-size: 4;
    tab-size: 4;
  
    -webkit-hyphens: none;
    -moz-hyphens: none;
    -ms-hyphens: none;
    hyphens: none;
  }
  
  </style>
  
  <script type="application/javascript">
  
  function is_downlevel_browser() {
    if (bowser.isUnsupportedBrowser({ msie: "12", msedge: "16"},
                                   window.navigator.userAgent)) {
      return true;
    } else {
      return window.load_distill_framework === undefined;
    }
  }
  
  // show body when load is complete
  function on_load_complete() {
  
    // set body to visible
    document.body.style.visibility = 'visible';
  
    // force redraw for leaflet widgets
    if (window.HTMLWidgets) {
      var maps = window.HTMLWidgets.findAll(".leaflet");
      $.each(maps, function(i, el) {
        var map = this.getMap();
        map.invalidateSize();
        map.eachLayer(function(layer) {
          if (layer instanceof L.TileLayer)
            layer.redraw();
        });
      });
    }
  
    // trigger 'shown' so htmlwidgets resize
    $('d-article').trigger('shown');
  }
  
  function init_distill() {
  
    init_common();
  
    // create front matter
    var front_matter = $('<d-front-matter></d-front-matter>');
    $('#distill-front-matter').wrap(front_matter);
  
    // create d-title
    $('.d-title').changeElementType('d-title');
  
    // create d-byline
    var byline = $('<d-byline></d-byline>');
    $('.d-byline').replaceWith(byline);
  
    // create d-article
    var article = $('<d-article></d-article>');
    $('.d-article').wrap(article).children().unwrap();
  
    // move posts container into article
    $('.posts-container').appendTo($('d-article'));
  
    // create d-appendix
    $('.d-appendix').changeElementType('d-appendix');
  
    // create d-bibliography
    var bibliography = $('<d-bibliography></d-bibliography>');
    $('#distill-bibliography').wrap(bibliography);
  
    // flag indicating that we have appendix items
    var appendix = $('.appendix-bottom').children('h3').length > 0;
  
    // replace citations with <d-cite>
    $('.citation').each(function(i, val) {
      appendix = true;
      var cites = $(this).attr('data-cites').split(" ");
      var dt_cite = $('<d-cite></d-cite>');
      dt_cite.attr('key', cites.join());
      $(this).replaceWith(dt_cite);
    });
    // remove refs
    $('#refs').remove();
  
    // replace footnotes with <d-footnote>
    $('.footnote-ref').each(function(i, val) {
      appendix = true;
      var href = $(this).attr('href');
      var id = href.replace('#', '');
      var fn = $('#' + id);
      var fn_p = $('#' + id + '>p');
      fn_p.find('.footnote-back').remove();
      var text = fn_p.html();
      var dtfn = $('<d-footnote></d-footnote>');
      dtfn.html(text);
      $(this).replaceWith(dtfn);
    });
    // remove footnotes
    $('.footnotes').remove();
  
    $('h1.appendix, h2.appendix').each(function(i, val) {
      $(this).changeElementType('h3');
    });
    $('h3.appendix').each(function(i, val) {
      var id = $(this).attr('id');
      $('.d-toc a[href="#' + id + '"]').parent().remove();
      appendix = true;
      $(this).nextUntil($('h1, h2, h3')).addBack().appendTo($('d-appendix'));
    });
  
    // show d-appendix if we have appendix content
    $("d-appendix").css('display', appendix ? 'grid' : 'none');
  
    // replace code blocks with d-code
    $('pre>code').each(function(i, val) {
      var code = $(this);
      var pre = code.parent();
      var clz = "";
      var language = pre.attr('class');
      if (language) {
        // map unknown languages to "clike" (without this they just dissapear)
        if ($.inArray(language, ["bash", "clike", "css", "go", "html",
                                 "javascript", "js", "julia", "lua", "markdown",
                                 "markup", "mathml", "python", "svg", "xml"]) == -1)
          language = "clike";
        language = ' language="' + language + '"';
        var dt_code = $('<d-code block' + language + clz + '></d-code>');
        dt_code.text(code.text());
        pre.replaceWith(dt_code);
      } else {
        code.addClass('text-output').unwrap().changeElementType('pre');
      }
    });
  
    // localize layout chunks to just output
    $('.layout-chunk').each(function(i, val) {
  
      // capture layout
      var layout = $(this).attr('data-layout');
  
      // apply layout to markdown level block elements
      var elements = $(this).children().not('d-code, pre.text-output, script');
      elements.each(function(i, el) {
        var layout_div = $('<div class="' + layout + '"></div>');
        if (layout_div.hasClass('shaded')) {
          var shaded_content = $('<div class="shaded-content"></div>');
          $(this).wrap(shaded_content);
          $(this).parent().wrap(layout_div);
        } else {
          $(this).wrap(layout_div);
        }
      });
  
  
      // unwrap the layout-chunk div
      $(this).children().unwrap();
    });
  
    // load distill framework
    load_distill_framework();
  
    // wait for window.distillRunlevel == 4 to do post processing
    function distill_post_process() {
  
      if (!window.distillRunlevel || window.distillRunlevel < 4)
        return;
  
      // hide author/affiliations entirely if we have no authors
      var front_matter = JSON.parse($("#distill-front-matter").html());
      var have_authors = front_matter.authors && front_matter.authors.length > 0;
      if (!have_authors)
        $('d-byline').addClass('hidden');
  
      // table of contents
      if (have_authors) // adjust border if we are in authors
        $('.d-toc').parent().addClass('d-article-with-toc');
  
      // strip links that point to #
      $('.authors-affiliations').find('a[href="#"]').removeAttr('href');
  
      // hide elements of author/affiliations grid that have no value
      function hide_byline_column(caption) {
        $('d-byline').find('h3:contains("' + caption + '")').parent().css('visibility', 'hidden');
      }
  
      // affiliations
      var have_affiliations = false;
      for (var i = 0; i<front_matter.authors.length; ++i) {
        var author = front_matter.authors[i];
        if (author.affiliation !== "&nbsp;") {
          have_affiliations = true;
          break;
        }
      }
      if (!have_affiliations)
        $('d-byline').find('h3:contains("Affiliations")').css('visibility', 'hidden');
  
      // published date
      if (!front_matter.publishedDate)
        hide_byline_column("Published");
  
      // document object identifier
      var doi = $('d-byline').find('h3:contains("DOI")');
      var doi_p = doi.next().empty();
      if (!front_matter.doi) {
        // if we have a citation and valid citationText then link to that
        if ($('#citation').length > 0 && front_matter.citationText) {
          doi.html('Citation');
          $('<a href="#citation"></a>')
            .text(front_matter.citationText)
            .appendTo(doi_p);
        } else {
          hide_byline_column("DOI");
        }
      } else {
        $('<a></a>')
           .attr('href', "https://doi.org/" + front_matter.doi)
           .html(front_matter.doi)
           .appendTo(doi_p);
      }
  
       // change plural form of authors/affiliations
      if (front_matter.authors.length === 1) {
        var grid = $('.authors-affiliations');
        grid.children('h3:contains("Authors")').text('Author');
        grid.children('h3:contains("Affiliations")').text('Affiliation');
      }
  
      // inject pre code styles (can't do this with a global stylesheet b/c a shadow root is used)
      $('d-code').each(function(i, val) {
        var style = document.createElement('style');
        style.innerHTML = 'pre code { padding-left: 10px; font-size: 12px; border-left: 2px solid rgba(0,0,0,0.1); } ' +
                          '@media(min-width: 768px) { pre code { padding-left: 18px; font-size: 14px; } }';
        if (this.shadowRoot)
          this.shadowRoot.appendChild(style);
      });
  
      // move appendix-bottom entries to the bottom
      $('.appendix-bottom').appendTo('d-appendix').children().unwrap();
      $('.appendix-bottom').remove();
  
      // clear polling timer
      clearInterval(tid);
  
      // show body now that everything is ready
      on_load_complete();
    }
  
    var tid = setInterval(distill_post_process, 50);
    distill_post_process();
  
  }
  
  function init_downlevel() {
  
    init_common();
  
     // insert hr after d-title
    $('.d-title').after($('<hr class="section-separator"/>'));
  
    // check if we have authors
    var front_matter = JSON.parse($("#distill-front-matter").html());
    var have_authors = front_matter.authors && front_matter.authors.length > 0;
  
    // manage byline/border
    if (!have_authors)
      $('.d-byline').remove();
    $('.d-byline').after($('<hr class="section-separator"/>'));
    $('.d-byline a').remove();
  
    // remove toc
    $('.d-toc-header').remove();
    $('.d-toc').remove();
    $('.d-toc-separator').remove();
  
    // move appendix elements
    $('h1.appendix, h2.appendix').each(function(i, val) {
      $(this).changeElementType('h3');
    });
    $('h3.appendix').each(function(i, val) {
      $(this).nextUntil($('h1, h2, h3')).addBack().appendTo($('.d-appendix'));
    });
  
  
    // inject headers into references and footnotes
    var refs_header = $('<h3></h3>');
    refs_header.text('References');
    $('#refs').prepend(refs_header);
  
    var footnotes_header = $('<h3></h3');
    footnotes_header.text('Footnotes');
    $('.footnotes').children('hr').first().replaceWith(footnotes_header);
  
    // move appendix-bottom entries to the bottom
    $('.appendix-bottom').appendTo('.d-appendix').children().unwrap();
    $('.appendix-bottom').remove();
  
    // remove appendix if it's empty
    if ($('.d-appendix').children().length === 0)
      $('.d-appendix').remove();
  
    // prepend separator above appendix
    $('.d-appendix').before($('<hr class="section-separator" style="clear: both"/>'));
  
    // trim code
    $('pre>code').each(function(i, val) {
      $(this).html($.trim($(this).html()));
    });
  
    // move posts-container right before article
    $('.posts-container').insertBefore($('.d-article'));
  
    $('body').addClass('downlevel');
  
    on_load_complete();
  }
  
  
  function init_common() {
  
    // jquery plugin to change element types
    (function($) {
      $.fn.changeElementType = function(newType) {
        var attrs = {};
  
        $.each(this[0].attributes, function(idx, attr) {
          attrs[attr.nodeName] = attr.nodeValue;
        });
  
        this.replaceWith(function() {
          return $("<" + newType + "/>", attrs).append($(this).contents());
        });
      };
    })(jQuery);
  
    // prevent underline for linked images
    $('a > img').parent().css({'border-bottom' : 'none'});
  
    // mark non-body figures created by knitr chunks as 100% width
    $('.layout-chunk').each(function(i, val) {
      var figures = $(this).find('img, .html-widget');
      if ($(this).attr('data-layout') !== "l-body") {
        figures.css('width', '100%');
      } else {
        figures.css('max-width', '100%');
        figures.filter("[width]").each(function(i, val) {
          var fig = $(this);
          fig.css('width', fig.attr('width') + 'px');
        });
  
      }
    });
  
    // auto-append index.html to post-preview links in file: protocol
    // and in rstudio ide preview
    $('.post-preview').each(function(i, val) {
      if (window.location.protocol === "file:")
        $(this).attr('href', $(this).attr('href') + "index.html");
    });
  
    // get rid of index.html references in header
    if (window.location.protocol !== "file:") {
      $('.distill-site-header a[href]').each(function(i,val) {
        $(this).attr('href', $(this).attr('href').replace("index.html", "./"));
      });
    }
  
    // add class to pandoc style tables
    $('tr.header').parent('thead').parent('table').addClass('pandoc-table');
    $('.kable-table').children('table').addClass('pandoc-table');
  
    // add figcaption style to table captions
    $('caption').parent('table').addClass("figcaption");
  
    // initialize posts list
    if (window.init_posts_list)
      window.init_posts_list();
  
    // implmement disqus comment link
    $('.disqus-comment-count').click(function() {
      window.headroom_prevent_pin = true;
      $('#disqus_thread').toggleClass('hidden');
      if (!$('#disqus_thread').hasClass('hidden')) {
        var offset = $(this).offset();
        $(window).resize();
        $('html, body').animate({
          scrollTop: offset.top - 35
        });
      }
    });
  }
  
  document.addEventListener('DOMContentLoaded', function() {
    if (is_downlevel_browser())
      init_downlevel();
    else
      window.addEventListener('WebComponentsReady', init_distill);
  });
  
  </script>
  
  <!--/radix_placeholder_distill-->
  <script src="keras-for-r_files/jquery-1.11.3/jquery.min.js"></script>
  <script src="keras-for-r_files/bowser-1.9.3/bowser.min.js"></script>
  <script src="keras-for-r_files/webcomponents-2.0.0/webcomponents.js"></script>
  <script src="keras-for-r_files/distill-2.2.21/template.v2.js"></script>
  <!--radix_placeholder_site_in_header-->
  <!--/radix_placeholder_site_in_header-->


</head>

<body>

<!--radix_placeholder_front_matter-->

<script id="distill-front-matter" type="text/json">
{"title":"Keras for R","description":"We are excited to announce that the keras package is now available on CRAN. The package provides an R interface to Keras, a high-level neural networks API developed with a focus on enabling fast experimentation.","authors":[{"author":"J.J. Allaire","authorURL":"https://github.com/jjallaire","affiliation":"RStudio","affiliationURL":"https://www.rstudio.com"}],"publishedDate":"2017-09-05T00:00:00.000+02:00","citationText":"Allaire, 2017"}
</script>

<!--/radix_placeholder_front_matter-->
<!--radix_placeholder_navigation_before_body-->
<!--/radix_placeholder_navigation_before_body-->
<!--radix_placeholder_site_before_body-->
<!--/radix_placeholder_site_before_body-->

<div class="d-title">
<h1>Keras for R</h1>
<p><p>We are excited to announce that the keras package is now available on CRAN. The package provides an R interface to Keras, a high-level neural networks API developed with a focus on enabling fast experimentation.</p></p>
</div>

<div class="d-byline">
  J.J. Allaire <a href="https://github.com/jjallaire" class="uri">https://github.com/jjallaire</a> (RStudio)<a href="https://www.rstudio.com" class="uri">https://www.rstudio.com</a>
  
<br/>09-05-2017
</div>

<div class="d-article">
<p>We are excited to announce that the <a href="https://tensorflow.rstudio.com/keras">keras package</a> is now available on CRAN. The package provides an R interface to <a href="https://keras.io">Keras</a>, a high-level neural networks API developed with a focus on enabling fast experimentation. Keras has the following key features:</p>
<ul>
<li><p>Allows the same code to run on CPU or on GPU, seamlessly.</p></li>
<li><p>User-friendly API which makes it easy to quickly prototype deep learning models.</p></li>
<li><p>Built-in support for convolutional networks (for computer vision), recurrent networks (for sequence processing), and any combination of both.</p></li>
<li><p>Supports arbitrary network architectures: multi-input or multi-output models, layer sharing, model sharing, etc. This means that Keras is appropriate for building essentially any deep learning model, from a memory network to a neural Turing machine.</p></li>
<li><p>Is capable of running on top of multiple back-ends including <a href="https://github.com/tensorflow/tensorflow">TensorFlow</a>, <a href="https://github.com/Microsoft/cntk">CNTK</a>, or <a href="https://github.com/Theano/Theano">Theano</a>.</p></li>
</ul>
<p>If you are already familiar with Keras and want to jump right in, check out <a href="https://tensorflow.rstudio.com/keras" class="uri">https://tensorflow.rstudio.com/keras</a> which has everything you need to get started including over 20 complete examples to learn from.</p>
<p>To learn a bit more about Keras and why we’re so excited to announce the Keras interface for R, read on!</p>
<h2 id="keras-and-deep-learning">Keras and Deep Learning</h2>
<p>Interest in deep learning has been accelerating rapidly over the past few years, and several deep learning frameworks have emerged over the same time frame. Of all the available frameworks, Keras has stood out for its productivity, flexibility and user-friendly API. At the same time, TensorFlow has emerged as a next-generation machine learning platform that is both extremely flexible and well-suited to production deployment.</p>
<p>Not surprisingly, Keras and TensorFlow have of late been pulling away from other deep learning frameworks:</p>
<blockquote class="twitter-tweet" data-lang="en">
<p lang="en" dir="ltr">
Google web search interest around deep learning frameworks over time. If you remember Q4 2015 and Q1-2 2016 as confusing, you weren't alone. <a href="https://t.co/1f1VQVGr8n">pic.twitter.com/1f1VQVGr8n</a>
</p>
— François Chollet (<span class="citation" data-cites="fchollet">@fchollet</span>) <a href="https://twitter.com/fchollet/status/871089784898310144">June 3, 2017</a>
</blockquote>
<script async src="//platform.twitter.com/widgets.js" charset="utf-8"></script>
<p>The good news about Keras and TensorFlow is that you don’t need to choose between them! The default backend for Keras is TensorFlow and Keras can be <a href="https://blog.keras.io/keras-as-a-simplified-interface-to-tensorflow-tutorial.html">integrated seamlessly</a> with TensorFlow workflows. There is also a pure-TensorFlow implementation of Keras with <a href="https://www.youtube.com/watch?v=UeheTiBJ0Io&amp;t=7s&amp;index=8&amp;list=PLOU2XLYxmsIKGc_NBoIhTn2Qhraji53cv">deeper integration</a> on the roadmap for later this year.</p>
<p>Keras and TensorFlow are the state of the art in deep learning tools and with the keras package you can now access both with a fluent R interface.</p>
<h2 id="getting-started">Getting Started</h2>
<h3 id="installation">Installation</h3>
<p>To begin, install the keras R package from CRAN as follows:</p>
<div class="layout-chunk" data-layout="l-body">
<pre class="r"><code>
install.packages(&quot;keras&quot;)</code></pre>
</div>
<p>The Keras R interface uses the <a href="https://www.tensorflow.org/">TensorFlow</a> backend engine by default. To install both the core Keras library as well as the TensorFlow backend use the <code>install_keras()</code> function:</p>
<div class="layout-chunk" data-layout="l-body">
<pre class="r"><code>
library(keras)
install_keras()</code></pre>
</div>
<p>This will provide you with default CPU-based installations of Keras and TensorFlow. If you want a more customized installation, e.g. if you want to take advantage of NVIDIA GPUs, see the documentation for <a href="https://tensorflow.rstudio.com/keras/reference/install_keras.html"><code>install_keras()</code></a>.</p>
<h3 id="mnist-example">MNIST Example</h3>
<p>We can learn the basics of Keras by walking through a simple example: recognizing handwritten digits from the <a href="https://en.wikipedia.org/wiki/MNIST_database">MNIST</a> dataset. MNIST consists of 28 x 28 grayscale images of handwritten digits like these:</p>
<p><img style="width: 50%;" src="https://www.tensorflow.org/images/MNIST.png"></p>
<p>The dataset also includes labels for each image, telling us which digit it is. For example, the labels for the above images are 5, 0, 4, and 1.</p>
<h4 id="preparing-the-data">Preparing the Data</h4>
<p>The MNIST dataset is included with Keras and can be accessed using the <code>dataset_mnist()</code> function. Here we load the dataset then create variables for our test and training data:</p>
<div class="layout-chunk" data-layout="l-body">
<pre class="r"><code>
library(keras)
mnist &lt;- dataset_mnist()
x_train &lt;- mnist$train$x
y_train &lt;- mnist$train$y
x_test &lt;- mnist$test$x
y_test &lt;- mnist$test$y</code></pre>
</div>
<p>The <code>x</code> data is a 3-d array <code>(images,width,height)</code> of grayscale values. To prepare the data for training we convert the 3-d arrays into matrices by reshaping width and height into a single dimension (28x28 images are flattened into length 784 vectors). Then, we convert the grayscale values from integers ranging between 0 to 255 into floating point values ranging between 0 and 1:</p>
<div class="layout-chunk" data-layout="l-body">
<pre class="r"><code>
# reshape
dim(x_train) &lt;- c(nrow(x_train), 784)
dim(x_test) &lt;- c(nrow(x_test), 784)
# rescale
x_train &lt;- x_train / 255
x_test &lt;- x_test / 255</code></pre>
</div>
<p>The <code>y</code> data is an integer vector with values ranging from 0 to 9. To prepare this data for training we <a href="https://www.quora.com/What-is-one-hot-encoding-and-when-is-it-used-in-data-science">one-hot encode</a> the vectors into binary class matrices using the Keras <code>to_categorical()</code> function:</p>
<div class="layout-chunk" data-layout="l-body">
<pre class="r"><code>
y_train &lt;- to_categorical(y_train, 10)
y_test &lt;- to_categorical(y_test, 10)</code></pre>
</div>
<h4 id="defining-the-model">Defining the Model</h4>
<p>The core data structure of Keras is a model, a way to organize layers. The simplest type of model is the <a href="https://tensorflow.rstudio.com/keras/articles/sequential_model.html">sequential model</a>, a linear stack of layers.</p>
<p>We begin by creating a sequential model and then adding layers using the pipe (<code>%&gt;%</code>) operator:</p>
<div class="layout-chunk" data-layout="l-body">
<pre class="r"><code>
model &lt;- keras_model_sequential() 
model %&gt;% 
  layer_dense(units = 256, activation = &quot;relu&quot;, input_shape = c(784)) %&gt;% 
  layer_dropout(rate = 0.4) %&gt;% 
  layer_dense(units = 128, activation = &quot;relu&quot;) %&gt;%
  layer_dropout(rate = 0.3) %&gt;%
  layer_dense(units = 10, activation = &quot;softmax&quot;)</code></pre>
</div>
<p>The <code>input_shape</code> argument to the first layer specifies the shape of the input data (a length 784 numeric vector representing a grayscale image). The final layer outputs a length 10 numeric vector (probabilities for each digit) using a <a href="https://en.wikipedia.org/wiki/Softmax_function">softmax activation function</a>.</p>
<p>Use the <code>summary()</code> function to print the details of the model:</p>
<div class="layout-chunk" data-layout="l-body">
<pre class="r"><code>
summary(model)</code></pre>
</div>
<pre style="box-shadow: none;"><code>Model
________________________________________________________________________________
Layer (type)                        Output Shape                    Param #     
================================================================================
dense_1 (Dense)                     (None, 256)                     200960      
________________________________________________________________________________
dropout_1 (Dropout)                 (None, 256)                     0           
________________________________________________________________________________
dense_2 (Dense)                     (None, 128)                     32896       
________________________________________________________________________________
dropout_2 (Dropout)                 (None, 128)                     0           
________________________________________________________________________________
dense_3 (Dense)                     (None, 10)                      1290        
================================================================================
Total params: 235,146
Trainable params: 235,146
Non-trainable params: 0
________________________________________________________________________________</code></pre>
<p>Next, compile the model with appropriate loss function, optimizer, and metrics:</p>
<div class="layout-chunk" data-layout="l-body">
<pre class="r"><code>
model %&gt;% compile(
  loss = &quot;categorical_crossentropy&quot;,
  optimizer = optimizer_rmsprop(),
  metrics = c(&quot;accuracy&quot;)
)</code></pre>
</div>
<h4 id="training-and-evaluation">Training and Evaluation</h4>
<p>Use the <code>fit()</code> function to train the model for 30 epochs using batches of 128 images:</p>
<div class="layout-chunk" data-layout="l-body">
<pre class="r"><code>
history &lt;- model %&gt;% fit(
  x_train, y_train, 
  epochs = 30, batch_size = 128, 
  validation_split = 0.2
)</code></pre>
</div>
<p>The <code>history</code> object returned by <code>fit()</code> includes loss and accuracy metrics which we can plot:</p>
<div class="layout-chunk" data-layout="l-body">
<pre class="r"><code>
plot(history)</code></pre>
</div>
<p><img src="https://keras.rstudio.com/images/training_history_ggplot2.png" /></p>
<p>Evaluate the model’s performance on the test data:</p>
<div class="layout-chunk" data-layout="l-body">
<pre class="r"><code>
model %&gt;% evaluate(x_test, y_test,verbose = 0)</code></pre>
</div>
<pre><code>
$loss
[1] 0.1149

$acc
[1] 0.9807</code></pre>
<p>Generate predictions on new data:</p>
<div class="layout-chunk" data-layout="l-body">
<pre class="r"><code>
model %&gt;% predict_classes(x_test)</code></pre>
</div>
<pre><code>
  [1] 7 2 1 0 4 1 4 9 5 9 0 6 9 0 1 5 9 7 3 4 9 6 6 5 4 0 7 4 0 1 3 1 3 4 7 2 7 1 2
 [40] 1 1 7 4 2 3 5 1 2 4 4 6 3 5 5 6 0 4 1 9 5 7 8 9 3 7 4 6 4 3 0 7 0 2 9 1 7 3 2
 [79] 9 7 7 6 2 7 8 4 7 3 6 1 3 6 9 3 1 4 1 7 6 9
 [ reached getOption(&quot;max.print&quot;) -- omitted 9900 entries ]</code></pre>
<p>Keras provides a vocabulary for building deep learning models that is simple, elegant, and intuitive. Building a question answering system, an image classification model, a neural Turing machine, or any other model is just as straightforward.</p>
<p>The <a href="https://tensorflow.rstudio.com/keras/articles/sequential_model.html">Guide to the Sequential Model</a> article describes the basics of Keras sequential models in more depth.</p>
<h2 id="examples">Examples</h2>
<p>Over 20 complete examples are available (special thanks to <span class="citation" data-cites="dfalbel">[@dfalbel]</span>(<a href="https://github.com/dfalbel" class="uri">https://github.com/dfalbel</a>) for his work on these!). The examples cover image classification, text generation with stacked LSTMs, question-answering with memory networks, transfer learning, variational encoding, and more.</p>
<table>
<colgroup>
<col style="width: 53%" />
<col style="width: 46%" />
</colgroup>
<thead>
<tr class="header">
<th>Example</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><a href="https://tensorflow.rstudio.com/keras/articles/examples/addition_rnn.html">addition_rnn</a></td>
<td>Implementation of sequence to sequence learning for performing addition of two numbers (as strings).</td>
</tr>
<tr class="even">
<td><a href="https://tensorflow.rstudio.com/keras/articles/examples/babi_memnn.html">babi_memnn</a></td>
<td>Trains a memory network on the bAbI dataset for reading comprehension.</td>
</tr>
<tr class="odd">
<td><a href="https://tensorflow.rstudio.com/keras/articles/examples/babi_rnn.html">babi_rnn</a></td>
<td>Trains a two-branch recurrent network on the bAbI dataset for reading comprehension.</td>
</tr>
<tr class="even">
<td><a href="https://tensorflow.rstudio.com/keras/articles/examples/cifar10_cnn.html">cifar10_cnn</a></td>
<td>Trains a simple deep CNN on the CIFAR10 small images dataset.</td>
</tr>
<tr class="odd">
<td><a href="https://tensorflow.rstudio.com/keras/articles/examples/conv_lstm.html">conv_lstm</a></td>
<td>Demonstrates the use of a convolutional LSTM network.</td>
</tr>
<tr class="even">
<td><a href="https://tensorflow.rstudio.com/keras/articles/examples/deep_dream.html">deep_dream</a></td>
<td>Deep Dreams in Keras.</td>
</tr>
<tr class="odd">
<td><a href="https://tensorflow.rstudio.com/keras/articles/examples/imdb_bidirectional_lstm.html">imdb_bidirectional_lstm</a></td>
<td>Trains a Bidirectional LSTM on the IMDB sentiment classification task.</td>
</tr>
<tr class="even">
<td><a href="https://tensorflow.rstudio.com/keras/articles/examples/imdb_cnn.html">imdb_cnn</a></td>
<td>Demonstrates the use of Convolution1D for text classification.</td>
</tr>
<tr class="odd">
<td><a href="https://tensorflow.rstudio.com/keras/articles/examples/imdb_cnn_lstm.html">imdb_cnn_lstm</a></td>
<td>Trains a convolutional stack followed by a recurrent stack network on the IMDB sentiment classification task.</td>
</tr>
<tr class="even">
<td><a href="https://tensorflow.rstudio.com/keras/articles/examples/imdb_fasttext.html">imdb_fasttext</a></td>
<td>Trains a FastText model on the IMDB sentiment classification task.</td>
</tr>
<tr class="odd">
<td><a href="https://tensorflow.rstudio.com/keras/articles/examples/imdb_lstm.html">imdb_lstm</a></td>
<td>Trains a LSTM on the IMDB sentiment classification task.</td>
</tr>
<tr class="even">
<td><a href="https://tensorflow.rstudio.com/keras/articles/examples/lstm_text_generation.html">lstm_text_generation</a></td>
<td>Generates text from Nietzsche’s writings.</td>
</tr>
<tr class="odd">
<td><a href="https://tensorflow.rstudio.com/keras/articles/examples/mnist_acgan.html">mnist_acgan</a></td>
<td>Implementation of AC-GAN (Auxiliary Classifier GAN ) on the MNIST dataset</td>
</tr>
<tr class="even">
<td><a href="https://tensorflow.rstudio.com/keras/articles/examples/mnist_antirectifier.html">mnist_antirectifier</a></td>
<td>Demonstrates how to write custom layers for Keras</td>
</tr>
<tr class="odd">
<td><a href="https://tensorflow.rstudio.com/keras/articles/examples/mnist_cnn.html">mnist_cnn</a></td>
<td>Trains a simple convnet on the MNIST dataset.</td>
</tr>
<tr class="even">
<td><a href="https://tensorflow.rstudio.com/keras/articles/examples/mnist_irnn.html">mnist_irnn</a></td>
<td>Reproduction of the IRNN experiment with pixel-by-pixel sequential MNIST in “A Simple Way to Initialize Recurrent Networks of Rectified Linear Units” by Le et al.</td>
</tr>
<tr class="odd">
<td><a href="https://tensorflow.rstudio.com/keras/articles/examples/mnist_mlp.html">mnist_mlp</a></td>
<td>Trains a simple deep multi-layer perceptron on the MNIST dataset.</td>
</tr>
<tr class="even">
<td><a href="https://tensorflow.rstudio.com/keras/articles/examples/mnist_hierarchical_rnn.html">mnist_hierarchical_rnn</a></td>
<td>Trains a Hierarchical RNN (HRNN) to classify MNIST digits.</td>
</tr>
<tr class="odd">
<td><a href="https://tensorflow.rstudio.com/keras/articles/examples/mnist_transfer_cnn.html">mnist_transfer_cnn</a></td>
<td>Transfer learning toy example.</td>
</tr>
<tr class="even">
<td><a href="https://tensorflow.rstudio.com/keras/articles/examples/neural_style_transfer.html">neural_style_transfer</a></td>
<td>Neural style transfer (generating an image with the same “content” as a base image, but with the “style” of a different picture).</td>
</tr>
<tr class="odd">
<td><a href="https://tensorflow.rstudio.com/keras/articles/examples/reuters_mlp.html">reuters_mlp</a></td>
<td>Trains and evaluates a simple MLP on the Reuters newswire topic classification task.</td>
</tr>
<tr class="even">
<td><a href="https://tensorflow.rstudio.com/keras/articles/examples/stateful_lstm.html">stateful_lstm</a></td>
<td>Demonstrates how to use stateful RNNs to model long sequences efficiently.</td>
</tr>
<tr class="odd">
<td><a href="https://tensorflow.rstudio.com/keras/articles/examples/variational_autoencoder.html">variational_autoencoder</a></td>
<td>Demonstrates how to build a variational autoencoder.</td>
</tr>
<tr class="even">
<td><a href="https://tensorflow.rstudio.com/keras/articles/examples/variational_autoencoder_deconv.html">variational_autoencoder_deconv</a></td>
<td>Demonstrates how to build a variational autoencoder with Keras using deconvolution layers.</td>
</tr>
</tbody>
</table>
<h2 id="learning-more">Learning More</h2>
<p>After you’ve become familiar with the basics, these articles are a good next step:</p>
<ul>
<li><p><a href="https://tensorflow.rstudio.com/keras/articles/sequential_model.html">Guide to the Sequential Model</a>. The sequential model is a linear stack of layers and is the API most users should start with.</p></li>
<li><p><a href="https://tensorflow.rstudio.com/keras/articles/functional_api.html">Guide to the Functional API</a>. The Keras functional API is the way to go for defining complex models, such as multi-output models, directed acyclic graphs, or models with shared layers.</p></li>
<li><p><a href="https://tensorflow.rstudio.com/keras/articles/training_visualization.html">Training Visualization</a>. There are a wide variety of tools available for visualizing training. These include plotting of training metrics, real time display of metrics within the RStudio IDE, and integration with the TensorBoard visualization tool included with TensorFlow.</p></li>
<li><p><a href="https://tensorflow.rstudio.com/keras/articles/applications.html">Using Pre-Trained Models</a>. Keras includes a number of deep learning models (Xception, VGG16, VGG19, ResNet50, InceptionVV3, and MobileNet) that are made available alongside pre-trained weights. These models can be used for prediction, feature extraction, and fine-tuning.</p></li>
<li><p><a href="https://tensorflow.rstudio.com/keras/articles/faq.html">Frequently Asked Questions</a>. Covers many additional topics including streaming training data, saving models, training on GPUs, and more.</p></li>
</ul>
<p>Keras provides a productive, highly flexible framework for developing deep learning models. We can’t wait to see what the R community will do with these tools!</p>
<!--radix_placeholder_article_footer-->
<!--/radix_placeholder_article_footer-->
</div>

<div class="d-appendix">
</div>


<!--radix_placeholder_site_after_body-->
<!--/radix_placeholder_site_after_body-->
<!--radix_placeholder_appendices-->
<div class="appendix-bottom"></div>
<!--/radix_placeholder_appendices-->
<!--radix_placeholder_navigation_after_body-->
<!--/radix_placeholder_navigation_after_body-->

</body>

</html>
